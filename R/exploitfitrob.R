# Derive Coefficients, standard error and p-value from a robust linear fit  against 1 explanatory variable (MASS::rlm)
#
#
# This function takes a robust fit against 1 explanatory variable (MASS::rlm) as input, 
#   - derives the number of degrees of freedom,
#   - fetches fit coefficients and standard error,
#   - calculates the corresponding p-value based on Student's t distribution,
#   - and returns a list of these.
#
# In:
#        rlm.fit   A robust fit against 1 explanatory variable generated by MASS::rlm function
#
# Intermediate:
#        df        Nb of degrees of freedom
#
# Out:
#       A list containing:
#          - Coeff      Coefficients of input rlm.fit 
#          - StdErr     Standard errors corresponding to coefficients of input rlm.fit 
#          - p          p-values corresponding to coefficients of input rlm.fit 
#
exploitfitrob <- function(rlm.fit) {
  n  <- length(rlm.fit$residuals)
  df <- n - length(rlm.fit$coefficients)
  coeffs <- summary(rlm.fit)$coefficients
  p.coeff <- 2 * ( 1 - stats::pt(q  = abs(coeffs[2, "t value"]),
                          df = df) )
  return(list(Coeff  = coeffs[2, "Value"],
              StdErr = coeffs[2, "Std. Error"],
              p      = p.coeff))
}

